<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¸‰å›½12R è©³ç´°æ¤œè¨¼</title>
    <style>
        body {
            font-family: 'Courier New', monospace;
            padding: 20px;
            background: #f5f5f5;
        }
        .result {
            background: white;
            padding: 20px;
            margin: 10px 0;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .success { border-left: 5px solid #4CAF50; }
        .error { border-left: 5px solid #f44336; }
        .warning { border-left: 5px solid #ff9800; }
        pre {
            background: #f5f5f5;
            padding: 10px;
            overflow-x: auto;
            border-radius: 3px;
        }
        h2 { margin-top: 0; }
    </style>
</head>
<body>
    <h1>ğŸ” ä¸‰å›½12R è©³ç´°æ¤œè¨¼</h1>
    <div id="results"></div>

    <script>
        const results = document.getElementById('results');

        async function verifyMikuni12R() {
            try {
                // ä¸‰å›½ã¯å ´ã‚³ãƒ¼ãƒ‰10
                const url = 'https://boatrace.shinta7023.workers.dev/api/odds/10/12?hd=20260218';
                
                results.innerHTML += `<div class="result">
                    <h2>ğŸ“¡ APIãƒªã‚¯ã‚¨ã‚¹ãƒˆ</h2>
                    <pre>${url}</pre>
                </div>`;

                const response = await fetch(url);
                const data = await response.json();

                results.innerHTML += `<div class="result">
                    <h2>ğŸ“¥ ãƒ¬ã‚¹ãƒãƒ³ã‚¹å…¨ä½“</h2>
                    <pre>${JSON.stringify(data, null, 2)}</pre>
                </div>`;

                // ãƒã‚§ãƒƒã‚¯1: ãƒ¬ãƒ¼ã‚¹é–‹å‚¬ç¢ºèª
                if (!data.hasRace) {
                    results.innerHTML += `<div class="result error">
                        <h2>âŒ ãƒã‚§ãƒƒã‚¯å¤±æ•—</h2>
                        <p>ä¸‰å›½12Rã¯ãƒ¬ãƒ¼ã‚¹é–‹å‚¬ãªã—ã¨è¿”ã•ã‚Œã¾ã—ãŸ</p>
                    </div>`;
                    return;
                }

                // ãƒã‚§ãƒƒã‚¯2: ã‚ªãƒƒã‚ºãƒ‡ãƒ¼ã‚¿ç¢ºèª
                if (!data.odds || !Array.isArray(data.odds)) {
                    results.innerHTML += `<div class="result error">
                        <h2>âŒ ãƒã‚§ãƒƒã‚¯å¤±æ•—</h2>
                        <p>ã‚ªãƒƒã‚ºãƒ‡ãƒ¼ã‚¿ãŒä¸æ­£ã§ã™</p>
                    </div>`;
                    return;
                }

                // ãƒã‚§ãƒƒã‚¯3: ç·æŠ•ç¥¨æ•°è¨ˆç®—
                const totalVotes = data.odds.reduce((sum, boat) => sum + (boat.voteTickets || 0), 0);
                
                const votesCheck = totalVotes === 180;
                results.innerHTML += `<div class="result ${votesCheck ? 'success' : 'error'}">
                    <h2>${votesCheck ? 'âœ…' : 'âŒ'} ç·æŠ•ç¥¨æ•°ãƒã‚§ãƒƒã‚¯</h2>
                    <p>åˆè¨ˆ: ${totalVotes}ç¥¨ (æœŸå¾…å€¤: 180ç¥¨)</p>
                    <p>å„è‰‡ã®å†…è¨³:</p>
                    <ul>
                        ${data.odds.map(boat => `<li>${boat.boatNumber}å·è‰‡: ${boat.voteTickets || 0}ç¥¨</li>`).join('')}
                    </ul>
                </div>`;

                // ãƒã‚§ãƒƒã‚¯4: 1å·è‰‡ã‚ªãƒƒã‚ºç¢ºèª
                const boat1 = data.odds.find(b => b.boatNumber === 1);
                if (!boat1) {
                    results.innerHTML += `<div class="result error">
                        <h2>âŒ 1å·è‰‡ãƒ‡ãƒ¼ã‚¿ãªã—</h2>
                    </div>`;
                    return;
                }

                const oddsCheck = boat1.oddsMin === 1.0 && boat1.oddsMax === 1.5;
                results.innerHTML += `<div class="result ${oddsCheck ? 'success' : 'error'}">
                    <h2>${oddsCheck ? 'âœ…' : 'âŒ'} 1å·è‰‡ã‚ªãƒƒã‚ºãƒã‚§ãƒƒã‚¯</h2>
                    <p>å–å¾—å€¤: ${boat1.oddsMin} - ${boat1.oddsMax}</p>
                    <p>æœŸå¾…å€¤: 1.0 - 1.5</p>
                </div>`;

                // æœ€çµ‚åˆ¤å®š
                if (votesCheck && oddsCheck) {
                    results.innerHTML += `<div class="result success">
                        <h2>ğŸ‰ ä¸‰å›½12R - å…¨ãƒã‚§ãƒƒã‚¯åˆæ ¼ï¼</h2>
                        <ul>
                            <li>âœ… ç·æŠ•ç¥¨æ•°: ${totalVotes}ç¥¨ = 180ç¥¨</li>
                            <li>âœ… 1å·è‰‡ã‚ªãƒƒã‚º: ${boat1.oddsMin}-${boat1.oddsMax} = 1.0-1.5</li>
                        </ul>
                    </div>`;
                } else {
                    results.innerHTML += `<div class="result error">
                        <h2>âŒ ä¸‰å›½12R - ãƒã‚§ãƒƒã‚¯ä¸åˆæ ¼</h2>
                        <p>ä¸Šè¨˜ã®ã‚¨ãƒ©ãƒ¼ã‚’ç¢ºèªã—ã¦ãã ã•ã„</p>
                    </div>`;
                }

            } catch (error) {
                results.innerHTML += `<div class="result error">
                    <h2>âŒ ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿ</h2>
                    <pre>${error.message}\n${error.stack}</pre>
                </div>`;
            }
        }

        // å®Ÿè¡Œ
        verifyMikuni12R();
    </script>
</body>
</html>
